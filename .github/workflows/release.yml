name: Release For New Electron Version

on:
  workflow_dispatch:
    inputs:
        version:
          description: Electron version to use with "v" prefix (e.g. v30.0.0)
          required: true

env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  test:
    uses: ./.github/workflows/test.yml
    with:
      electron-version: ${{ github.event.inputs.version }}
  tag_new_version:
    runs-on: ubuntu-latest
    needs: test
    permissions:
      contents: write # for pushing new tag
    steps:
      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4.1.7
      # Tag here, the publish-npm.yml workflow will trigger on the new tag and do the CFA publish
      - name: Push New Tag
        run: |
          git tag ${{ github.event.inputs.version }}
          git push origin ${{ github.event.inputs.version }}
